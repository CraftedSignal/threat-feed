id: brief-2024-01-31-open-s3-buckets
slug: 2024-01-open-s3-buckets
title: Detection of Newly Created Open S3 Buckets
summary: Newly created, publicly accessible Amazon S3 buckets can expose sensitive data and provide an entry point for unauthorized access, necessitating prompt detection and remediation.
severity: high
published_at: "2024-01-31T12:00:00Z"
content: |
    ## Overview

    The creation of publicly accessible Amazon S3 buckets poses a significant security risk. While the provided source material lacks specific details about actors or campaigns, the potential for data exposure and unauthorized access makes this a critical issue. This threat brief focuses on detecting the initial creation of these open buckets, allowing for rapid response and mitigation. Successful exploitation can lead to significant data breaches, compliance violations, and reputational damage. The absence of actor-specific information necessitates a focus on technical detection and generic mitigation strategies. Defenders should prioritize monitoring cloud infrastructure logs for S3 bucket creation events and access control changes.

    ## Attack Chain

    1.  An attacker gains access to a cloud account through compromised credentials, weak authentication, or exploiting a misconfiguration in IAM policies.
    2.  The attacker uses the AWS Management Console, CLI, or SDK to create a new S3 bucket within the compromised account.
    3.  The attacker modifies the S3 bucket's access control lists (ACLs) or bucket policies to grant public read and/or write access. This may involve setting the ACL to "public-read" or "public-read-write", or configuring a bucket policy that allows access from any principal ("*").
    4.  The attacker uploads sensitive data into the newly created, publicly accessible S3 bucket. This data may include customer information, internal documents, API keys, or other confidential materials.
    5.  The attacker tests the public accessibility of the bucket by accessing it from an unauthenticated IP address or using a web browser.
    6.  The attacker leverages the publicly accessible bucket to host malicious content, such as phishing pages or malware, for distribution to unsuspecting victims.
    7.  External parties discover the open S3 bucket through search engines or vulnerability scans, potentially leading to widespread data exposure.

    ## Impact

    The impact of publicly accessible S3 buckets can be severe. Data breaches can expose sensitive information belonging to customers, employees, or the organization itself, leading to financial losses, legal liabilities, and reputational damage. Organizations in regulated industries may face significant fines for non-compliance. Publicly accessible buckets can also be exploited to host and distribute malware or phishing attacks, further amplifying the damage. The absence of access controls allows anyone to read, modify, or delete data within the bucket.
tags:
    - cloud
    - s3
    - misconfiguration
    - data-exfiltration
references:
    - https://github.com/splunk/security_content/blob/main/detections/cloud/detect_new_open_s3_buckets.yml
rules:
    - title: Detect S3 Bucket Created with Public Read ACL
      description: Detects the creation of an S3 bucket with a public read access control list (ACL), indicating a potential misconfiguration leading to data exposure.
      logsource:
        category: cloudtrail
        product: aws
      detection:
        condition: selection
        selection:
            eventname: CreateBucket
            requestparameters.acl: public-read
      level: high
      tags:
        - attack.credential_access
        - attack.t1530
      tests:
        positive:
            - name: S3 Bucket Created with Public Read ACL
              data:
                - eventname: CreateBucket
                  requestparameters.acl: public-read
                  requestparameters.bucketname: test-bucket-public-read
        negative:
            - name: S3 Bucket Created with Private ACL
              data:
                - eventname: CreateBucket
                  requestparameters.acl: private
                  requestparameters.bucketname: test-bucket-private
    - title: Detect S3 Bucket Policy Allowing Public Access
      description: 'Detects the creation or modification of an S3 bucket policy that grants public access (Principal: ''*''), potentially exposing sensitive data.'
      logsource:
        category: cloudtrail
        product: aws
      detection:
        condition: selection
        selection:
            eventname: PutBucketPolicy
            requestparameters.bucketpolicy|contains: '{"Principal":"*"}'
      level: critical
      tags:
        - attack.credential_access
        - attack.t1530
      tests:
        positive:
            - name: S3 Bucket Policy Allowing Public Access
              data:
                - eventname: PutBucketPolicy
                  requestparameters.bucketpolicy: '{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Principal":"*","Action":"s3:GetObject","Resource":"arn:aws:s3:::examplebucket/*"}]}'
        negative:
            - name: S3 Bucket Policy Restricting Access
              data:
                - eventname: PutBucketPolicy
                  requestparameters.bucketpolicy: '{"Version":"2012-10-17","Statement":[{"Effect":"Allow","Principal":{"AWS":"arn:aws:iam::123456789012:user/John"},"Action":"s3:GetObject","Resource":"arn:aws:s3:::examplebucket/*"}]}'
ttps:
    - tactic_id: TA0003
      tactic_name: Persistence
      technique_id: T1530
      technique_name: Data from Cloud Storage Object
