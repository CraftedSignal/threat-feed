id: brief-2024-01-02-ttx-ttp-gap
slug: 2024-01-ttx-ttp-gap
title: 'Readiness Assessment Gap: TTX vs. TTP Replay Discrepancy'
summary: Organizations overestimate their security readiness due to a disconnect between theoretical tabletop exercises (TTX) and practical threat emulation, leading to undetected adversarial behaviors during real attacks.
severity: medium
published_at: "2024-01-02T12:00:00Z"
content: |
    ## Overview

    A significant gap exists between organizations' perceived security readiness (94%) and their actual ability to detect and respond to real-world attacks (22%). This discrepancy arises from the siloed approach to security assessments, where theoretical tabletop exercises (TTX) are conducted independently of practical technical testing. Organizations often fail to validate whether their assumptions made during TTXs align with their actual detection capabilities. The lack of integration between strategic decision-making during TTXs and the technical telemetry generated by security tools like EDRs results in an inaccurate assessment of true readiness. Bridging this gap requires combining TTXs with TTP replays to create a feedback loop that improves playbooks and telemetry.

    ## Attack Chain

    1.  **Initial Access:** An attacker gains initial access through an unpatched vulnerability or compromised credential (simulated during TTP replay).
    2.  **Privilege Escalation:** The attacker attempts to escalate privileges using techniques like exploiting misconfigured services or leveraging known privilege escalation exploits (simulated during TTP replay).
    3.  **Credential Access:** The attacker dumps credentials from memory or retrieves them from configuration files (simulated during TTP replay).
    4.  **Discovery:** The attacker performs internal reconnaissance to identify valuable data and systems (simulated during TTP replay). Tools like `net.exe` or `PowerView` might be used.
    5.  **Lateral Movement:** The attacker moves laterally to other systems using techniques like pass-the-hash or remote service execution (simulated during TTP replay).
    6.  **Data Exfiltration:** The attacker stages and exfiltrates sensitive data to an external location (simulated during TTP replay). This could involve tools like `rsync` or `scp`.
    7.  **Ransomware Deployment:** The attacker deploys ransomware across the network, encrypting critical files and demanding a ransom (simulated during TTP replay).
    8.  **Impact:** Business operations are disrupted due to encrypted systems and data loss, resulting in financial losses and reputational damage.

    ## Impact

    Failure to validate TTX assumptions with real-world TTP replays leads to a false sense of security. Organizations are unable to detect and respond effectively to attacks, resulting in potential data breaches, ransomware infections, and significant operational disruptions. Recent data indicates that organizations overestimate their security readiness by over 70%, highlighting the severity of this gap. This can lead to financial losses, reputational damage, and regulatory penalties.
tags:
    - tabletop-exercise
    - ttp-replay
    - security-assessment
references:
    - https://www.reddit.com/r/blueteamsec/comments/1r9zl87/the_readiness_illusion_why_tabletop_exercises/
    - https://www.lares.com/blog/ttx-and-ttp-replay-combo/
rules:
    - title: Detect Net.exe Usage for Discovery
      description: Detects the use of net.exe for reconnaissance activities, a common TTP used during lateral movement.
      logsource:
        category: process_creation
        product: windows
      detection:
        condition: selection
        selection:
            CommandLine|contains:
                - ' view '
                - ' user '
                - ' group '
                - ' share '
            Image|endswith: \net.exe
      level: medium
      tags:
        - attack.discovery
        - attack.t1018
      tests:
        positive:
            - name: net view command
              data:
                - CommandLine: net view \\server
                  Image: C:\Windows\System32\net.exe
            - name: net user command
              data:
                - CommandLine: net user administrator
                  Image: C:\Windows\System32\net.exe
        negative:
            - name: net help command
              data:
                - CommandLine: net help
                  Image: C:\Windows\System32\net.exe
    - title: Detect Suspicious PowerShell Downgrade Attempt
      description: Detects attempts to downgrade PowerShell versions, often used to bypass security restrictions.
      logsource:
        category: process_creation
        product: windows
      detection:
        condition: selection
        selection:
            CommandLine|contains:
                - -version 2
                - -version 3
                - -version 4
                - -version 5
            Image|endswith: \powershell.exe
      level: high
      tags:
        - attack.defense_evasion
        - attack.t1027
      tests:
        positive:
            - name: PowerShell downgraded to version 2
              data:
                - CommandLine: powershell.exe -version 2 -command Get-Host
                  Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
        negative:
            - name: Normal PowerShell command
              data:
                - CommandLine: powershell.exe -command Get-Host
                  Image: C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe
    - title: Detecting RSync use from unusual locations
      description: Detects rsync usage from non-standard directories indicating lateral movement or data exfiltration
      logsource:
        category: process_creation
        product: windows
      detection:
        condition: selection and not filter
        filter:
            Image|startswith:
                - C:\Program Files\
                - C:\Windows\
        selection:
            Image|endswith: \rsync.exe
      level: medium
      tags:
        - attack.exfiltration
        - attack.t1020
      tests:
        positive:
            - name: rsync execution from temp folder
              data:
                - CommandLine: rsync -avz source dest
                  Image: C:\Users\user1\AppData\Local\Temp\rsync.exe
        negative:
            - name: rsync execution from program files
              data:
                - CommandLine: rsync -avz source dest
                  Image: C:\Program Files\rsync\rsync.exe
ttps:
    - tactic_id: TA0007
      tactic_name: Discovery
      technique_id: T1018
      technique_name: Remote System Discovery
    - tactic_id: TA0005
      tactic_name: Defense Evasion
      technique_id: T1027
      technique_name: Obfuscated Files or Information
