id: brief-2024-01-03-aws-ecr-scan-findings
slug: 2024-01-aws-ecr-scan-findings
title: AWS ECR Container Scanning Findings - Low/Informational
summary: This brief covers detection of low or informational findings from AWS Elastic Container Registry (ECR) container scanning, indicating potential configuration issues or outdated components within container images.
severity: low
published_at: "2024-01-03T12:00:00Z"
content: |
    ## Overview

    This detection focuses on identifying low and informational findings generated by AWS ECR container scanning. While these findings are not immediately critical, they often highlight areas where container images can be improved for security and operational efficiency. These findings can include outdated software packages, misconfigurations, or deviations from security best practices. Addressing these findings reduces the overall attack surface and enhances the security posture of containerized applications. The detection is based on analysis of security content available on GitHub. This helps security teams identify and prioritize vulnerabilities in their container deployments. While no specific actor or campaign is associated, proactive monitoring of these findings improves overall security.

    ## Attack Chain

    1. A developer builds a container image using publicly available base images and adds application code.
    2. The container image is pushed to an AWS ECR repository.
    3. AWS ECR's integrated container scanning service automatically scans the image for vulnerabilities.
    4. The scan identifies low or informational findings such as outdated libraries or non-critical security flaws.
    5. The findings are logged within AWS Security Hub or other integrated security tools.
    6. An attacker could potentially leverage identified low severity vulnerabilities to gain a foothold in the container environment.
    7. Successful exploitation allows the attacker to escalate privileges and move laterally within the container infrastructure.

    ## Impact

    Low and informational findings from container scans, while not immediately critical, indicate potential security weaknesses. Neglecting these findings can lead to a gradual accumulation of vulnerabilities, increasing the risk of a successful attack. These findings may highlight outdated software components that are susceptible to known exploits, or configuration issues that could be leveraged by attackers. Ignoring these findings can also result in compliance violations and increased operational costs. While the direct impact is low, the cumulative effect of unaddressed findings can significantly degrade the overall security posture of containerized applications.
tags:
    - cloud
    - aws
    - container
    - vulnerability
references:
    - https://github.com/splunk/security_content/blob/main/detections/cloud/aws_ecr_container_scanning_findings_low_informational_unknown.yml
rules:
    - title: Detect AWS ECR Container Scanning Findings - Low Severity
      description: Detects low severity findings reported by AWS ECR container scanning.
      logsource:
        category: cloudtrail
        product: aws
      detection:
        condition: selection
        selection:
            eventName: DescribeImageScanFindings
            eventSource: ecr.amazonaws.com
            severity: LOW
      level: low
      tags:
        - attack.t1595.002
      tests:
        positive:
            - name: ECR scan finding - low severity
              data:
                - eventName: DescribeImageScanFindings
                  eventSource: ecr.amazonaws.com
                  findingArn: arn:aws:inspector2:us-east-1:123456789012:finding/1234abcd-12ab-34cd-56ef-1234567890ab
                  severity: LOW
        negative:
            - name: ECR scan finding - critical severity
              data:
                - eventName: DescribeImageScanFindings
                  eventSource: ecr.amazonaws.com
                  findingArn: arn:aws:inspector2:us-east-1:123456789012:finding/1234abcd-12ab-34cd-56ef-1234567890ab
                  severity: CRITICAL
    - title: Detect AWS ECR Container Scanning Findings - Informational Severity
      description: Detects informational severity findings reported by AWS ECR container scanning.
      logsource:
        category: cloudtrail
        product: aws
      detection:
        condition: selection
        selection:
            eventName: DescribeImageScanFindings
            eventSource: ecr.amazonaws.com
            severity: INFORMATIONAL
      level: informational
      tags:
        - attack.t1595.002
      tests:
        positive:
            - name: ECR scan finding - informational severity
              data:
                - eventName: DescribeImageScanFindings
                  eventSource: ecr.amazonaws.com
                  findingArn: arn:aws:inspector2:us-east-1:123456789012:finding/1234abcd-12ab-34cd-56ef-1234567890ab
                  severity: INFORMATIONAL
        negative:
            - name: ECR scan finding - high severity
              data:
                - eventName: DescribeImageScanFindings
                  eventSource: ecr.amazonaws.com
                  findingArn: arn:aws:inspector2:us-east-1:123456789012:finding/1234abcd-12ab-34cd-56ef-1234567890ab
                  severity: HIGH
ttps:
    - tactic_id: TA0007
      tactic_name: Discovery
      technique_id: T1595
      technique_name: Active Scanning
      subtechnique_id: T1595.002
      subtechnique_name: Vulnerability Scanning
