id: brief-2024-02-29-titus-secrets-scanner
slug: 2024-02-titus-secrets-scanner
title: Praetorian Titus Secrets Scanner Open Sourced
summary: Praetorian has released Titus, an open-source secrets scanner that validates live credentials and scans binary file formats, aiding blue teams in identifying exposed credentials within their infrastructure.
severity: medium
published_at: "2024-02-29T10:00:00Z"
content: |
    ## Overview

    Praetorian has open-sourced Titus, a secrets scanner designed to identify and validate credentials within an organization's infrastructure. Unlike traditional scanners that rely solely on pattern matching, Titus can make controlled API calls to verify if detected credentials are active, tagging results as confirmed, denied, or unknown. The tool supports scanning binary file formats, including Office documents, PDFs, Jupyter notebooks, SQLite databases, and archives (zip, tar, jar, apk, ipa), with recursive extraction capabilities. It includes 450+ detection rules covering cloud providers, CI/CD tokens, SaaS API keys, and database connection strings, drawing from Nosey Parker and MongoDB's Kingfisher. Titus offers a CLI, Go library, Burp Suite extension, and a Chrome extension, with SARIF output for CI/CD pipeline integration.

    ## Attack Chain

    This section describes how an attacker could leverage leaked credentials found by Titus.

    1. **Credential Exposure:** Sensitive credentials (e.g., AWS keys, API tokens) are unintentionally committed to a source code repository or stored within a scanned binary file (e.g., a misconfigured mobile app).
    2. **Titus Scan:** A defender runs Titus against internal repositories, file shares, or artifact repositories, detecting the exposed credentials.
    3. **Attacker Discovery:** An attacker gains unauthorized access to the exposed repository, file share, or intercepts network traffic where credentials are being transmitted.
    4. **Credential Harvesting:** The attacker identifies the leaked credentials through manual inspection or automated scripts.
    5. **Privilege Escalation:** Using the compromised credentials, the attacker authenticates to a cloud provider, SaaS application, or database server.
    6. **Lateral Movement:** The attacker leverages their initial access to discover additional resources and move laterally within the network.
    7. **Data Exfiltration:** The attacker accesses sensitive data and exfiltrates it to an external location.
    8. **Impact:** The attacker causes damage to the organization's systems, disrupts operations, or demands a ransom.

    ## Impact

    Successful exploitation of leaked credentials can lead to significant damage, including unauthorized access to sensitive data, financial loss, and reputational damage. Organizations that fail to implement proper credential management practices are particularly vulnerable. Depending on the permissions associated with the exposed credentials, attackers could potentially gain complete control over critical infrastructure, leading to widespread disruption and data breaches.
tags:
    - secrets-scanning
    - credential-theft
    - supply-chain
references:
    - https://www.reddit.com/r/blueteamsec/comments/1ra60rd/praetorian_open_sourced_titus_a_secrets_scanner/
    - https://github.com/praetorian-inc/titus
    - https://www.praetorian.com/blog/titus-open-source-secret-scanner/
rules:
    - title: Detect Titus Execution
      description: Detects execution of the Titus CLI based on the process name.
      logsource:
        category: process_creation
        product: windows
      detection:
        condition: selection
        selection:
            Image|endswith: \titus.exe
      level: informational
      tags:
        - attack.discovery
      tests:
        positive:
            - name: Titus execution from command line
              data:
                - CommandLine: titus scan /path/to/repo
                  Image: C:\Users\tester\Downloads\titus.exe
                  ParentImage: C:\Windows\System32\cmd.exe
        negative:
            - name: Normal command line usage
              data:
                - CommandLine: dir
                  Image: C:\Windows\System32\cmd.exe
                  ParentImage: C:\Windows\explorer.exe
    - title: Detect Potential Credential Exposure via Titus Output
      description: Detects file modifications where Titus reports potential credential exposure based on SARIF output.
      logsource:
        category: file_event
        product: windows
      detection:
        condition: selection
        selection:
            Image|endswith: \titus.exe
            Operation: Write
            TargetFilename|endswith: .sarif
      level: medium
      tags:
        - attack.discovery
      tests:
        positive:
            - name: Titus writing SARIF output
              data:
                - Image: C:\Users\tester\Downloads\titus.exe
                  Operation: Write
                  TargetFilename: C:\Users\tester\Desktop\results.sarif
                  User: S-1-5-21-...
        negative:
            - name: Normal SARIF file write
              data:
                - Image: C:\Program Files\SomeApp\someapp.exe
                  Operation: Write
                  TargetFilename: C:\Users\tester\Desktop\report.sarif
                  User: S-1-5-21-...
ttps:
    - tactic_id: TA0007
      tactic_name: Discovery
      technique_id: T1592
      technique_name: Gather Victim Host Information
      subtechnique_id: T1592.002
      subtechnique_name: Software
    - tactic_id: TA0009
      tactic_name: Collection
      technique_id: T1113
      technique_name: Screen Capture
    - tactic_id: TA0006
      tactic_name: Credential Access
      technique_id: T1552
      technique_name: Unsecured Credentials
      subtechnique_id: T1552.001
      subtechnique_name: Credentials in Files
